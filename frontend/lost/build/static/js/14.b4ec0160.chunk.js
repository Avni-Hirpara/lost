(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1014:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),i=a(1023),c=a(5),o=a.n(c),l=a(10),u=a(487),s=a(163),d=a(161),m=a(823),f=a.n(m),p=function error(e){f.a.fire({position:"center",type:"error",title:e,showConfirmButton:!1,timer:4e3})},b=function alertDelete(){return f.a.fire({title:"Are you sure?",text:"You won't be able to revert this!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})},_=a(23),g=a(197),k=a(2),v=a(508),E=a.n(v),w=a(1016),h=a(975),O=a(68),j=a(66),y=a(1010);function timesIcon(e){return e?n.a.createElement(h.a,{onClick:function onClick(){e("edit_isDesigner")},icon:!0},n.a.createElement(O.a,{size:"big",name:"times circle outline",color:"red"})):n.a.createElement(O.a,{size:"big",name:"times circle outline",color:"red"})}function checkIcon(e){return e?n.a.createElement(h.a,{onClick:function onClick(){e("edit_isDesigner")},icon:!0},n.a.createElement(O.a,{size:"big",name:"check circle outline",color:"green"})):n.a.createElement(O.a,{size:"big",name:"check circle outline",color:"green"})}function GroupLabelsEditable(e){var t=e.row,a=e.callback,i=Object(_.c)(),c=Object(_.d)(function(e){return e.group.groups}),o=Object(r.useState)(c.map(function(e){return{selected:!1,name:e.name}})),l=Object(u.a)(o,2),d=l[0],m=l[1],f=function getGroups(){return i(s.a.getGroupsAction())};return Object(r.useEffect)(function(){!function fetchGroups(){f()}()},[]),Object(r.useEffect)(function(){m(c.map(function(e){return{selected:!!t.edit_groups.filter(function(t){return t.name===e.name}).length,name:e.name}}))},[t]),n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,d.map(function(e){return n.a.createElement(j.a,{style:{margin:3,cursor:"pointer"},color:e.selected?"green":"grey",onClick:function onClick(e){a("edit_groups",d.filter(function(t){return t.name===e.currentTarget.innerHTML?!t.selected:t.selected}))}},e.name)})))}function GroupLabels(e){var t=e.row;return n.a.createElement(n.a.Fragment,null,t.groups.map(function(e){return n.a.createElement(j.a,{color:"green",style:{margin:3}},e.name)}))}function textInput(e,t,a){return n.a.createElement(y.a,null,function textInputInner(e,t,a){return t||(t={}),n.a.createElement(y.a.Input,{style:{width:130},disabled:t.disabled,value:t.value,error:t.error,type:"edit_password"===e||"edit_confirm_password"===e?"password":"text",fluid:!0,onChange:function onChange(t){a(e,t.currentTarget.value)}})}(e,t,a))}function BaseTable(e){var t=e.tableData.header,a=Object(r.useState)(""),i=Object(u.a)(a,2),c=i[0],s=i[1],d=e.tableData.header.map(function(e){return e.key}),m=e.tableData.data.map(function(e){var t={};return d.forEach(function(a){t=Object(k.a)({},t,Object(g.a)({},a,e[a]))}),t}),f=Object(r.useState)(m),p=Object(u.a)(f,2),_=p[0],v=p[1],O=Object(r.useState)(""),j=Object(u.a)(O,2),y=j[0],C=j[1];Object(r.useEffect)(function(){v(m)},[e.tableData.data]);var D=function myCustomCell(t,a){var r=t[a];switch(a){case"isDesigner":case"isAnnotator":return r?checkIcon():timesIcon();case"edit":return function editButton(e,t){return n.a.createElement(h.a,{basic:!0,color:"blue",onClick:function onClick(){e("edit",t)}},"Edit")}(e.callback,t);case"deleteUser":return function deleteButton(e,t){return n.a.createElement(h.a,{basic:!0,color:"red",onClick:Object(l.a)(o.a.mark(function _callee(){return o.a.wrap(function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b();case 2:a.sent.value&&e("delete",t);case 4:case"end":return a.stop()}},_callee,this)}))},"Delete")}(e.callback,t);case"groups":return n.a.createElement(GroupLabels,{row:t});case"edit_user_name":case"edit_email":case"edit_password":case"edit_confirm_password":return textInput(a,r,e.callback);case"edit_isDesigner":return r?checkIcon(e.callback):timesIcon(e.callback);case"edit_groups":return n.a.createElement(GroupLabelsEditable,{row:t,callback:e.callback});default:return r}};return n.a.createElement(w.a,{sortable:!0,celled:!0},n.a.createElement(w.a.Header,null,n.a.createElement(w.a.Row,null,t.map(function(e){return n.a.createElement(w.a.HeaderCell,{key:e.key,sorted:c===e.key?y:null,onClick:function onClick(){return function handleSort(e){if(c!==e)return s(e),v(E.a.sortBy(_,[e])),void C("ascending");v(_.reverse()),C("ascending"===y?"descending":"ascending")}(e.key)}},e.title)}))),n.a.createElement(w.a.Body,null,_.map(function(e,t){return n.a.createElement(w.a.Row,{key:e.user_name+t},Object.keys(e).map(function(t,a){return n.a.createElement(w.a.Cell,{style:{textAlign:"center"},key:a},D(e,t))}))})))}var C=a(1003);var D=function GroupTable(){var e=Object(_.d)(function(e){return e.group.groups}),t=Object(_.d)(function(e){return e.user.users}),a=Object(_.c)(),i=function getGroups(){return a(s.a.getGroupsAction())},c=function deleteGroup(e){return a(s.a.deleteGroupAction(e))},d=e.map(function(e){return{groupName:e.name}}),m=Object(r.useState)(""),f=Object(u.a)(m,2),b=f[0],g=f[1],k={header:[{title:"Group",key:"groupName"},{title:"",key:"deleteUser"}],data:d};Object(r.useEffect)(function(){!function fetchGroups(){i()}()},[]);var v=function(){var t=Object(l.a)(o.a.mark(function _callee(t,a){var r;return o.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return r=e.filter(function(e){return e.name==a.groupName})[0],t.next=3,c(r.idx);case 3:i();case 4:case"end":return t.stop()}},_callee,this)}));return function dataTableCallback(e,a){return t.apply(this,arguments)}}();return n.a.createElement("div",null,n.a.createElement(C.a,{value:b,action:n.a.createElement(h.a,{basic:!0,color:"blue",onClick:function onClick(){t.filter(function(e){return e.user_name===b}).length?p("groupname and username can not be the same"):e.filter(function(e){return e.name===b}).length?p("groupname already taken"):(function createGroup(e){a(s.a.createGroupAction(e))}({group_name:b}),g(""),i())}},"Add Group"),onChange:function onChange(e){return g(e.currentTarget.value)},iconPosition:"left",placeholder:"Groupname"}),e.length>0&&n.a.createElement(BaseTable,{tableData:k,callback:v}))},U=a(981),G=a(807),x=a(808),A=a(809),T="min 4 char",B="no valid email",I="min 5 char",S="passwords do not match",L={edit_user_name:{value:"",error:T,disabled:!1},edit_email:{value:"",error:B},edit_isDesigner:!1,edit_password:{value:"",error:I},edit_confirm_password:{value:"",error:S},edit_groups:[]},z=function(e){var t,a=Object(_.d)(function(e){return e.group.groups}),i=Object(_.d)(function(e){return e.user.users}),c=Object(r.useState)(L),o=Object(u.a)(c,2),l=o[0],s=o[1],m=Object(_.c)();l&&(t=[{edit_user_name:l.edit_user_name,edit_email:l.edit_email,edit_isDesigner:l.edit_isDesigner,edit_password:l.edit_password,edit_confirm_password:l.edit_confirm_password,edit_groups:l.edit_groups}]);var f={header:[{title:"Username",key:"edit_user_name"},{title:"Email",key:"edit_email"},{title:"Designer",key:"edit_isDesigner"},{title:"Password",key:"edit_password"},{title:"Confirm Password",key:"edit_confirm_password"},{title:"Groups",key:"edit_groups"}],data:t};Object(r.useEffect)(function(){e.editUserData?s({idx:e.editUserData.idx,edit_user_name:{value:e.editUserData.user_name,error:void 0,disabled:!0},edit_email:{value:e.editUserData.email,error:void 0},edit_isDesigner:e.editUserData.isDesigner,edit_password:{value:"",error:void 0},edit_confirm_password:{value:"",error:void 0},edit_groups:e.editUserData.groups}):s(L)},[e.editUserData]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(U.a,{style:{minWidth:900},isOpen:e.modalIsOpen,toggle:e.toggle},n.a.createElement(G.a,null,e.editUserData?"Edit User":"Add User"),n.a.createElement(x.a,null,n.a.createElement(BaseTable,{tableData:f,callback:function dataTableCallback(e,t){switch(e){case"edit_user_name":s(Object(k.a)({},l,{edit_user_name:{value:t,error:t.length>3?void 0:T}}));break;case"edit_email":s(Object(k.a)({},l,{edit_email:{value:t,error:t.includes("@")?void 0:B}}));break;case"edit_isDesigner":s(Object(k.a)({},l,{edit_isDesigner:!l.edit_isDesigner}));break;case"edit_password":s(Object(k.a)({},l,{edit_password:{value:t,error:t.length>4?void 0:I},edit_confirm_password:Object(k.a)({},l.edit_confirm_password,{error:l.edit_confirm_password.value===t?void 0:S})}));break;case"edit_confirm_password":s(Object(k.a)({},l,{edit_password:Object(k.a)({},l.edit_password,{error:l.edit_password.value.length>4?void 0:I}),edit_confirm_password:{value:t,error:l.edit_password.value===t?void 0:S}}));break;case"edit_groups":s(Object(k.a)({},l,{edit_groups:t}))}}})),n.a.createElement(A.a,null,n.a.createElement(h.a,{basic:!0,color:"red",onClick:function onClick(){e.toggle()}},"Abort"),n.a.createElement(h.a,{basic:!0,color:"green",onClick:function onClick(){var t=!0;if(Object.keys(l).forEach(function(e){l[e].error&&(t=!1)}),t){var r=["Annotater"];l.edit_isDesigner&&r.push("Designer");var n={email:l.edit_email.value,password:l.edit_password.value,roles:r,groups:l.edit_groups.map(function(e){return e.name})};if(l.idx){!function updateUser(e){m(d.a.updateUserAction(e))}(Object(k.a)({},n,{idx:l.idx,first_name:"",last_name:""}))}else{var c=Object(k.a)({},n,{user_name:l.edit_user_name.value});if(a.filter(function(e){return e.name===c.user_name}).length)return void p("username and groupname can not be the same");if(i.filter(function(e){return e.user_name===c.user_name||e.email===c.email}).length)return void p("username/email already taken");!function createUser(e){m(d.a.createUserAction(e))}(c)}s(L),e.toggle()}}},"Save"))))};var F=function UserTable(){var e=Object(_.d)(function(e){return e.user.users}),t=Object(_.c)(),a=function getUsers(){return t(d.a.getUsersAction())};Object(r.useEffect)(function(){!function fetchUsers(){a()}()},[]),e=e.map(function(e){var t=void 0!=e.roles.filter(function(e){return"Designer"===e.name})[0],a=void 0!=e.roles.filter(function(e){return"Annotator"===e.name})[0];return Object(k.a)({key:e.user_name},e,{isDesigner:t,isAnnotator:a,deletable:!0,changeable:!0})});var i=Object(r.useState)(!1),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(r.useState)(),m=Object(u.a)(s,2),f=m[0],p=m[1],b={header:[{title:"Username",key:"user_name"},{title:"Email",key:"email"},{title:"Designer",key:"isDesigner"},{title:"Groups",key:"groups"},{title:"",key:"edit"},{title:"",key:"deleteUser"}],data:e};return n.a.createElement("div",null,n.a.createElement(z,{editUserData:f,modalIsOpen:o,toggle:function toggle(){o&&p(),l(!o)}}),n.a.createElement(h.a,{basic:!0,color:"blue",onClick:function onClick(){l(!0)}},"Add User"),n.a.createElement(BaseTable,{tableData:b,callback:function dataTableCallback(a,r){var n=e.filter(function(e){return e.user_name===r.user_name})[0];"edit"===a?(l(!0),p(n)):"delete"===a&&function deleteUser(e){t(d.a.deleteUserAction(e))}(n.idx)}}))};t.default=function Users_Users(){return n.a.createElement(i.a,{columns:2,divided:!0,style:{backgroundColor:"white",padding:15}},n.a.createElement(i.a.Row,null,n.a.createElement(i.a.Column,{width:5},n.a.createElement(D,null)),n.a.createElement(i.a.Column,{width:11},n.a.createElement(F,null))))}}}]);
//# sourceMappingURL=14.b4ec0160.chunk.js.map