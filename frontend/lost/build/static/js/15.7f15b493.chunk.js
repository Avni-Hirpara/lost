(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1025:function(e,t,a){"use strict";a.r(t);var n=a(11),r=a(14),l=a(20),o=a(19),c=a(21),s=a(1),i=a.n(s),m=a(993),u=a(994),d=a(996),h=a(997),k=a(74),p=a(23),g=a(571),b=a(404),f=a(1004),E=a(913),v=a(833),O=a(530),w=a.n(O),L=a(26),y=L.a.getWorkers,W=L.a.getWorkerLogFile,M={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",width:"85%",height:"85%",maxWidth:"75rem"},overlay:{backgroundColor:"rgba(0,0,0,0.75)"}},N=function(e){function WorkersTable(e){var t;return Object(n.a)(this,WorkersTable),(t=Object(l.a)(this,Object(o.a)(WorkersTable).call(this,e))).state={logBlobUrl:"",modalIsOpen:!1},t.openModal=t.openModal.bind(Object(k.a)(Object(k.a)(t))),t.afterOpenModal=t.afterOpenModal.bind(Object(k.a)(Object(k.a)(t))),t.closeModal=t.closeModal.bind(Object(k.a)(Object(k.a)(t))),t}return Object(c.a)(WorkersTable,e),Object(r.a)(WorkersTable,[{key:"openModal",value:function openModal(){this.setState({modalIsOpen:!0})}},{key:"afterOpenModal",value:function afterOpenModal(){}},{key:"closeModal",value:function closeModal(){this.setState({modalIsOpen:!1})}},{key:"componentDidMount",value:function componentDidMount(){var e=this;this.props.getWorkers(),this.workertimer=setInterval(function(){return e.props.getWorkers()},1e3)}},{key:"handleLogfileButtonClick",value:function handleLogfileButtonClick(e){var t=this;this.props.getWorkerLogFile("".concat(e.worker_name,".log")).then(function(e){return t.setState({logBlobUrl:window.URL.createObjectURL(e)})}),this.openModal()}},{key:"componentWillUnmount",value:function componentWillUnmount(){clearInterval(this.workertimer),this.workertimer=null}},{key:"renderLogFile",value:function renderLogFile(){var e=this;return""!==this.state.logBlobUrl?i.a.createElement(v.ScrollFollow,{startFollowing:!0,render:function render(t){var a=t.follow,n=t.onScroll;return i.a.createElement(v.LazyLog,{url:e.state.logBlobUrl,stream:!0,follow:a,onScroll:n})}}):i.a.createElement("div",null)}},{key:"renderLogFileModal",value:function renderLogFileModal(){return i.a.createElement(w.a,{isOpen:this.state.modalIsOpen,onAfterOpen:this.afterOpenModal,onRequestClose:this.closeModal,style:M,ariaHideApp:!1,contentLabel:"Logfile"},i.a.createElement(d.a,{style:{height:"90%"}},i.a.createElement(g.a,null,i.a.createElement("i",{className:"fa fa-question-circle"})," Logs"),i.a.createElement(h.a,{style:{height:"100%"}},this.renderLogFile()),i.a.createElement(b.a,{color:"success",onClick:this.closeModal},i.a.createElement("i",{className:"fa fa-times"})," Close")))}},{key:"renderTableBody",value:function renderTableBody(){var e=this;return i.a.createElement("tbody",null,this.props.workers.map(function(t){var a="success",n="Online";if(t.timestamp){var r=new Date(Date.now()-15e3);new Date("".concat(t.timestamp,"Z"))<r&&(a="danger",n="Offline")}return i.a.createElement("tr",{key:t.idx},i.a.createElement("td",{className:"text-center"},i.a.createElement("div",null,t.worker_name),i.a.createElement("div",{className:"small text-muted"},"ID: ",t.idx)),i.a.createElement("td",null,i.a.createElement("div",null,t.env_name),i.a.createElement("div",{className:"small text-muted"},"Registered at: ",new Date("".concat(t.register_timestamp,"Z")).toLocaleString())),i.a.createElement("td",{className:"text-center"},i.a.createElement("div",null,i.a.createElement(f.a,{color:a},n)),i.a.createElement("div",{className:"small text-muted"},"Last life sign: ",new Date("".concat(t.timestamp,"Z")).toLocaleString())),i.a.createElement("td",{className:"text-center"},i.a.createElement("div",null,t.resources)),i.a.createElement("td",{className:"text-center"},i.a.createElement("div",null,t.in_progress)),i.a.createElement("td",{className:"text-center"},i.a.createElement(b.a,{onClick:function onClick(){return e.handleLogfileButtonClick(t)}},"Logs")))}))}},{key:"render",value:function render(){return i.a.createElement(i.a.Fragment,null,this.renderLogFileModal(),i.a.createElement(E.a,{hover:!0,responsive:!0,className:"table-outline mb-0 d-none d-sm-table"},i.a.createElement("thead",{className:"thead-light"},i.a.createElement("tr",null,i.a.createElement("th",{className:"text-center"},"Name"),i.a.createElement("th",{className:"text-center"},"Environment"),i.a.createElement("th",{className:"text-center"},"Status"),i.a.createElement("th",{className:"text-center"},"Resources"),i.a.createElement("th",{className:"text-center"},"Jobs"),i.a.createElement("th",{className:"text-center"},"Logs"))),this.renderTableBody()))}}]),WorkersTable}(s.Component);var x=Object(p.b)(function mapStateToProps(e){return{workers:e.worker.workers}},{getWorkers:y,getWorkerLogFile:W})(N),j=function(e){function Workers(){return Object(n.a)(this,Workers),Object(l.a)(this,Object(o.a)(Workers).apply(this,arguments))}return Object(c.a)(Workers,e),Object(r.a)(Workers,[{key:"render",value:function render(){return i.a.createElement(m.a,null,i.a.createElement(u.a,{xs:"12",sm:"12",lg:"12"},i.a.createElement(d.a,{className:"text-black"},i.a.createElement(h.a,null,i.a.createElement(x,null)))))}}]),Workers}(s.Component);t.default=j}}]);
//# sourceMappingURL=15.7f15b493.chunk.js.map